<!doctype html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Foundation | Welcome</title>
  <link rel="stylesheet" href="https://dhbhdrzi4tiry.cloudfront.net/cdn/sites/foundation.min.css">
</head>
<body>
<!-- Start Top Bar -->
<div class="top-bar">
  <div class="row">
    <div class="top-bar-left">
      <ul class="dropdown menu" data-dropdown-menu>
        <li class="menu-text">Evalu-EAT! Stores</li>
        <li class="has-submenu">
          <a href="#">Options</a>
          <ul class="submenu menu vertical" data-submenu>
			<li><a href="index.html">Home</a></li>
            <li><a href="register.html">register</a></li>
            <li><a href="login.html">login</a></li>
            <li><a href="profile.html">profile</a></li>
			<li><a href="abstract.html">Abstract</a></li>
            <!--<li><a href="edit_profile.html">edit profile</a></li>-->
          </ul>
        </li>
      </ul>
    </div>
    <div class="top-bar-right">
	<!--
      <ul class="menu">
        <li><input type="search" placeholder="Search"></li>
        <li><button type="button" class="button">Search</button></li>
      </ul>
	  -->
	  
    </div>
  </div>
</div>
<!-- End Top Bar -->
<br>
<!-- You can now combine a row and column if you just need a 12 column row -->
<div class="row columns">
  <nav aria-label="You are here:" role="navigation">
    <ul class="breadcrumbs">
      <li><a href="index.html">Home</a></li>
    <!--  <li><a href="#">Features</a></li> -->
    
    </ul>
  </nav>
</div>

<div class="row">
  <div class="medium-6 columns">
    <img class="thumbnail" src="images/jollibee_01-650x350.jpg">
    <div class="row small-up-4">
      <div class="column">
        <img class="thumbnail" src="images/jollibee_02-250x200.jpg">
      </div>
      <div class="column">
        <img class="thumbnail" src="images/jollibee_03-250x200.jpg">
      </div>
      <div class="column">
        <img class="thumbnail" src="images/jollibee_04-250x250.jpg">
      </div>
      <div class="column">
        <img class="thumbnail" src="images/jollibee_05-250x250.jpg">
      </div>
    </div>
  </div>
  <div class="medium-6 large-5 columns">
    <h3>Jollibee</h3>
    <p> Jollibee is the largest fast food chain brand in the Philippines, operating a network of more than 1,500 stores in 17 countries. 
	A dominant market leader in the Philippines, Jollibee enjoys the lionâ€™s share of the local market that is more than all the other 
	multinational fast food brands in PH combined. </p>

<!---
    <label>Size
      <select>
        <option value="husker">Small</option>
        <option value="starbuck">Medium</option>
        <option value="hotdog">Large</option>
        <option value="apollo">EvalaBig</option>
      </select>
    </label>

    <div class="row">
      <div class="small-3 columns">
        <label for="middle-label" class="middle">Quantity</label>
      </div>
      <div class="small-9 columns">
        <input type="text" id="middle-label" placeholder="One fish two fish">
      </div>
    </div>

    <a href="#" class="button large expanded">Buy Now</a>
--->

    <div class="small secondary expanded button-group">
      <a class="button">Facebook</a>
      <a class="button">Twitter</a>
      <a class="button">Instagram</a>
    </div>
  </div>
</div>

<!--------------------- THE REVIEW PORTION OF THE WEBPAGE ---------------------->

<div class="column row" id="theReviewJollibee">
  <hr>
  <ul class="tabs" data-tabs id="example-tabs">
    <li class="tabs-title is-active"><a href="#panel1" aria-selected="true">Reviews</a></li>
    <li class="tabs-title"><a href="#panel2">Similar Products</a></li>
  </ul>
  <div class="tabs-content" data-tabs-content="example-tabs">
    <div class="tabs-panel is-active" id="panel1">
  
  <div id="review-section">
    <h4>Reviews</h4>
    <div id="comment-list" class="media-object stack-for-small">
      <!-- Comments will be displayed here -->
    </div>
    <label>
      My Review
      <input id="review-name" type="text" placeholder="pseudonym ">
      <textarea id="review-comment" placeholder="Your Comment"></textarea>
    </label>
    <button id="submit-review-comment" class="button">Submit Comment</button>
	</div>
</div>
	
    <div class="tabs-panel" id="panel2">
      <div class="row medium-up-3 large-up-5">
        <div class="column">
          <img class="thumbnail" src="images/mcdo_04-350x200.jpg">
          <h5>Mcdo <small>Mcdo</small></h5>
          <p>Love ko to at love kita.</p>
          <a href="mcdo.html" class="button hollow tiny expanded">View Now</a>
        </div>
        <div class="column">
          <img class="thumbnail" src="images/kfc_04-350x200.jpg">
          <h5>KFC <small>KFC</small></h5>
          <p>This ain't the only thing finger lickin' good.</p>
          <a href="kfc.html" class="button hollow tiny expanded">View Now</a>
        </div>
        <div class="column">
          <img class="thumbnail" src="images/burgerking_04-350x200.jpg">
          <h5>Burger King <small>BurgerKing</small></h5>
          <p>I may be the King but imma call you my Queen.</p>
          <a href="burgerking.html" class="button hollow tiny expanded">View Now</a>
        </div>
        <div class="column">
          <img class="thumbnail" src="images/pizzahut_04-350x200.jpg">
          <h5>Pizza hut <small>Pizzahut</small></h5>
          <p>Our cheese melts like how you made my heart melt.</p>
          <a href="pizzahut.html" class="button hollow tiny expanded">View Now</a>
        </div>
        <div class="column">
          <img class="thumbnail" src="images/wendys_04-350x200.jpg">
          <h5>Wendy's <small>Wendy's</small></h5>
          <p>Unlike my pony tails, you'll get tied down with me forever.</p>
          <a href="wendys.html" class="button hollow tiny expanded">View Now</a>
        </div>
      </div>
    </div>
	
  </div>
</div>
<!-------------------------------------------->



<div class="row column">
  <hr>
  <ul class="menu">
    <li class="menu-text">Evalu-EAT! Store</li>
	<!---
    <li><a href="#">Home</a></li>
    <li><a href="#">About</a></li>
    <li><a href="#">Contact</a></li>
	--->
    <li class="float-right">Copyright 2023</li>
  </ul>
</div>

  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script src="https://dhbhdrzi4tiry.cloudfront.net/cdn/sites/foundation.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js"></script>

  <script>
    $(document).foundation();


	$('#submit-review').click(function() {
		var name = $('#review-name').val();
		var comment = $('#review-comment').val();
		var image = 'images/random_200x200.jpg'; // Set the image path to 'images/ichigo.jpg'
  
	if (name && comment) {
		var review = $('<div class="media-object stack-for-small">');
		var imageSection = $('<div class="media-object-section">');
		var thumbnail = $('<img class="thumbnail" src="' + image + '">');
		var contentSection = $('<div class="media-object-section">');
		var reviewName = $('<h5>').text(name);
		var reviewComment = $('<p>').text(comment);

		imageSection.append(thumbnail);
		contentSection.append(reviewName, reviewComment);
		review.append(imageSection, contentSection);

		$('#review-list').prepend(review);

		$('#review-name').val('');
		$('#review-comment').val('');
  }
});

</script>

<!-- Firebase Script -->
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } 
  from "https://www.gstatic.com/firebasejs/10.1.0/firebase-app.js";
  import { 
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    onAuthStateChanged,
    signOut
  }
  from "https://www.gstatic.com/firebasejs/10.1.0/firebase-auth.js";
  import { getDatabase, set, ref, remove, update, push, onValue } 
  from "https://www.gstatic.com/firebasejs/10.1.0/firebase-database.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyArQhKxYACdF_DHYaEh2qWlM-ZqvoM8ebo",
  authDomain: "evalu-eat-547a3.firebaseapp.com",
  databaseURL: "https://evalu-eat-547a3-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "evalu-eat-547a3",
  storageBucket: "evalu-eat-547a3.appspot.com",
  messagingSenderId: "295860521362",
  appId: "1:295860521362:web:c421ebd81f0ab6e574594b"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const auth = getAuth(app);

  // Reference to the comments section in the Firebase database
  const commentsRef = ref(database, 'Comments');
  
  // Function to delete a comment
  const deleteComment = async (commentKey) => {
    // Check if the user is logged in
    const user = auth.currentUser;
    if (user) {
      const commentRefToDelete  = ref(database, `Comments/${user.uid}/${commentKey}`);
      //const commentRefToDelete = child(userCommentsRef, commentKey);

      // Delete the comment from the database
      await remove(commentRefToDelete);

      // Refresh the comments
      displayComments();
    } else {
      alert('Please log in to delete a comment.');
    }
  };
  
  // Function for submitting a comment with context
const submitComment = async (context) => {
  const name = $('#review-name').val();
  const commentText = $('#review-comment').val();

  if (name && commentText) {
    // Check if the user is logged in
    const user = auth.currentUser;
    if (user) {
	  const userEmail = user.email; // Fetch the user's email
      // Push the comment data to the database with the specified context
      const userCommentsRef = ref(database, `Comments/${user.uid}`);
      const newCommentRef = push(userCommentsRef);
      set(newCommentRef, {
		Email: userEmail,
        Name: name,
        Comment: commentText,
        Context: context,
      });

      $('#review-name').val('');
      $('#review-comment').val('');
    } else {
      alert('Please log in to submit a comment.');
    }
  }
};

// Add event listener to the "Submit Comment" button
$('#submit-review-comment').click(() => {
  submitComment('jollibee'); // Pass the context ('burgerking' for burgerking) here
});

// Function to fetch and display comments from the database
const displayComments = () => {
  onValue(commentsRef, (snapshot) => {
    const commentsList = snapshot.val();
    const commentListElement = document.getElementById('comment-list');

    if (commentsList) {
      // Clear previous comments
      commentListElement.innerHTML = '';

      let commentsHTML = ''; // Accumulator for comment HTML

      // Loop through user UIDs
      Object.keys(commentsList).forEach((userUID) => {
        const userComments = commentsList[userUID];

        // Loop through comments within the user's UID
        Object.keys(userComments).forEach((commentKey) => {
          const comment = userComments[commentKey];
			
		  if (comment.Context === 'jollibee') {
          commentsHTML += `
		  
		  <div class="tabs-content" data-tabs-content="example-tabs">
			<div class="tabs-panel is-active" id="panel1">
				<div id="review-list" class="media-object stack-for-small">
					<div class="media-object stack-for-small">
						<div class="media-object-section">
							<img class="thumbnail" src="images/random_200x200.jpg">
						</div>
			
							<div class="media-object-section">
								<h5>Email: ${comment.Email}</h5>
								<p>Name: ${comment.Name}</p>
								<p>Comment: ${comment.Comment}</p>
							<!--	<p>Restaurant: ${comment.Context}</p>  Display the context -->
								
								<!-- Display "Delete" button only if userUID matches -->
								${
								auth.currentUser && userUID === auth.currentUser.uid
								? `<button class="delete-comment-button" data-comment-key="${commentKey}" style="color: red;">Delete</button>`
								: ''
								}
							</div>
					</div>
				</div>
			</div>
		   </div>
        `;
		 }
        });
      });

      // Set the accumulated HTML at once
      commentListElement.innerHTML = commentsHTML;
    } else {
      commentListElement.innerHTML = 'No comments yet.';
    }
  });
};

		// Call displayComments when the page loads
	window.onload = () => {
		displayComments('jollibee');
		};
		
	// Event listener to handle comment deletion
    $(document).on('click', '.delete-comment-button', function () {
      const commentKey = $(this).data('comment-key');
      deleteComment(commentKey);
    });
  
		
		
		
		
	    $(document).ready(() => {
      $(document).foundation();
    });	
</script>


</body>
</html>